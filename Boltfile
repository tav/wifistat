# Public Domain (-) 2012 The Wifistat Authors.
# See the Wifistat UNLICENSE file for details.

from os.path import join

from bolt.api import *

tmpl = """// Public Domain (-) 2012 The Wifistat Authors.
// See the Wifistat UNLICENSE file for details.

// DO NOT EDIT THIS FILE DIRECTLY. IT IS AUTOGENERATED BY BOLT.

package main

const indexHTML = `%s`

var (
        indexHTMLBytes = []byte(indexHTML)
)
"""

def read_file(filename):
    f = open(filename, 'rb')
    data = f.read()
    f.close()
    return data.strip()

@task
def build():
    """build wifistat"""

    local('assetgen assetgen.yaml')

    css = read_file('build/wifistat.css')
    js = read_file('build/wifistat.js')
    html = read_file('template/index.html')

    f = open('html.go', 'wb')
    f.write(tmpl % html.replace('%JS%', js).replace('%CSS%', css))
    f.close()

@task
def clean():
    """clean wifistat build"""

    local('assetgen assetgen.yaml --clean')
